<pre>
<font color="#434f54">&#47;&#47;A: IMPORT THE LIBRARIES AND DEFINITIONS</font>
<font color="#434f54">&#47;&#47;A1: DECLARATIONS FOR CURIEIMU</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;CurieIMU.h&#34;</font>

<font color="#00979c">int</font> <font color="#000000">axIn</font><font color="#434f54">,</font> <font color="#000000">ayIn</font><font color="#434f54">,</font> <font color="#000000">azIn</font><font color="#000000">;</font>

<font color="#00979c">double</font> <font color="#000000">vsumcurrentIn</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#00979c">double</font> <font color="#000000">vsumcheckIn</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#00979c">double</font> <font color="#000000">vsumnewIn</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#434f54">&#47;&#47;A1: END</font>

<font color="#434f54">&#47;&#47;A2: DECLARATIONS FOR EXTERNAL ACCELEROMETER</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;I2Cdev.h&#34;</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;MPU6050.h&#34;</font>

<font color="#5e6d03">#if</font> <font color="#000000">I2CDEV_IMPLEMENTATION</font> <font color="#434f54">==</font> <font color="#000000">I2CDEV_ARDUINO_WIRE</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;Wire.h&#34;</font>
<font color="#5e6d03">#endif</font>

<font color="#000000">MPU6050</font> <font color="#000000">accelgyro</font><font color="#000000">;</font>

<font color="#00979c">int16_t</font> <font color="#000000">axEx</font><font color="#434f54">,</font> <font color="#000000">ayEx</font><font color="#434f54">,</font> <font color="#000000">azEx</font><font color="#434f54">,</font> <font color="#000000">gxEx</font><font color="#434f54">,</font> <font color="#000000">gyEx</font><font color="#434f54">,</font> <font color="#000000">gzEx</font><font color="#000000">;</font>
<font color="#00979c">double</font> <font color="#000000">byEx</font><font color="#434f54">,</font> <font color="#000000">bxEx</font><font color="#434f54">,</font> <font color="#000000">bzEx</font><font color="#000000">;</font>

<font color="#00979c">double</font> <font color="#000000">vsumcurrentEx</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#00979c">double</font> <font color="#000000">vsumcheckEx</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
<font color="#00979c">double</font> <font color="#000000">vsumnewEx</font> <font color="#434f54">=</font> <font color="#000000">0</font> <font color="#000000">;</font>
<font color="#434f54">&#47;&#47;A2: END</font>

<font color="#434f54">&#47;&#47;A3: DECLARATIONS FOR SDCARD MODULE</font>
<font color="#5e6d03">#include</font> <font color="#434f54">&lt;</font><b><font color="#d35400">SPI</font></b><font color="#434f54">.</font><font color="#000000">h</font><font color="#434f54">&gt;</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;SdFat.h&#34;</font>

<font color="#5e6d03">#define</font> <font color="#000000">USE_SDIO</font> <font color="#000000">0</font> <font color="#434f54">&#47;&#47; Set USE_SDIO to zero for SPI card access</font>

<font color="#00979c">const</font> <font color="#00979c">uint8_t</font> <font color="#000000">SD_CHIP_SELECT</font> <font color="#434f54">=</font> <font color="#000000">SS</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47; Default SD Chip select is the SPI SS pin</font>

<font color="#5e6d03">#if</font> <font color="#000000">USE_SDIO</font> <font color="#434f54">&#47;&#47; Use faster SdioCardEX</font>
<font color="#000000">SdFatSdioEX</font> <font color="#000000">sd</font><font color="#000000">;</font>
<font color="#5e6d03">#else</font> <font color="#434f54">&#47;&#47; USE_SDIO</font>
<font color="#000000">SdFat</font> <font color="#000000">sd</font><font color="#000000">;</font>
<font color="#5e6d03">#endif</font> &nbsp;<font color="#434f54">&#47;&#47; USE_SDIO</font>

<font color="#00979c">float</font> <font color="#000000">cardSize</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47; global for card size</font>
<b><font color="#d35400">File</font></b> <font color="#000000">myFile</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;will be used for file creation</font>
<font color="#000000">SdFile</font> <font color="#000000">file</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;will be used for getting filenames</font>
<font color="#434f54">&#47;&#47;A3: END</font>

<font color="#434f54">&#47;&#47;A4: DECLARATIONS FOR GPS GSM RTC SHIELD</font>
<font color="#5e6d03">#include</font> <font color="#434f54">&lt;</font><b><font color="#d35400">SoftwareSerial</font></b><font color="#434f54">.</font><font color="#000000">h</font><font color="#434f54">&gt;</font>

<font color="#5e6d03">#define</font> <font color="#000000">DEBUG</font> <font color="#00979c">true</font>
<font color="#5e6d03">#define</font> <font color="#000000">GPSready</font> <font color="#000000">A2</font>

<b><font color="#d35400">SoftwareSerial</font></b> <font color="#000000">mySerial</font><font color="#000000">(</font><font color="#000000">7</font><font color="#434f54">,</font> <font color="#000000">8</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#434f54">&#47;&#47;A4: END</font>

<font color="#434f54">&#47;&#47;A5: OTHER DECLARATIONS</font>
<font color="#5e6d03">#define</font> <font color="#000000">DeviceReady</font> <font color="#000000">A1</font>
<font color="#5e6d03">#define</font> <font color="#000000">FallMemory</font> <font color="#000000">A0</font>

<font color="#5e6d03">#define</font> <font color="#000000">falseAlarmButton</font> <font color="#000000">A3</font>

<font color="#00979c">unsigned</font> <font color="#00979c">long</font> <font color="#00979c">int</font> <font color="#000000">fallStart</font><font color="#000000">;</font>

<font color="#00979c">double</font> <font color="#000000">degreesdiff</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>

<font color="#00979c">String</font> <font color="#000000">lastOrientation</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
<font color="#00979c">String</font> <font color="#000000">lastKnownTimeLoc</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
<font color="#00979c">String</font> <font color="#000000">userName</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
<font color="#434f54">&#47;&#47;A5: END</font>

<font color="#434f54">&#47;&#47;A6: DECLARATIONS FOR KEEPING TRACK OF ACTIVITIES</font>
<font color="#5e6d03">#define</font> <font color="#000000">maxAct</font> <font color="#000000">1000</font> <font color="#434f54">&#47;&#47;Maximum number of activities per text file</font>
<font color="#00979c">int</font> <font color="#000000">actFileCountR</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;activity file counter</font>
<font color="#00979c">int</font> <font color="#000000">actCounterR</font><font color="#000000">;</font> &nbsp;&nbsp;<font color="#434f54">&#47;&#47;activity counter per file</font>
<font color="#434f54">&#47;&#47;A6: END</font>

<font color="#434f54">&#47;&#47;A7: DECLARATIONS FOR TIMER</font>
<font color="#5e6d03">#include</font> <font color="#005c5f">&#34;CurieTimerOne.h&#34;</font>
<font color="#00979c">const</font> <font color="#00979c">int</font> <font color="#000000">gpsTimer</font> <font color="#434f54">=</font> <font color="#000000">5000000</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;5 seconds</font>
<font color="#00979c">const</font> <font color="#00979c">int</font> <font color="#000000">memoryTimer</font> <font color="#434f54">=</font> <font color="#000000">9000000</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;9 seconds</font>
<font color="#434f54">&#47;&#47;A7: END</font>

<font color="#434f54">&#47;&#47;A: END</font>

<font color="#00979c">void</font> <font color="#000000">parseAndsave</font><font color="#000000">(</font><font color="#00979c">char</font> <font color="#434f54">*</font><font color="#000000">buff</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">char</font> <font color="#434f54">*</font><font color="#d35400">name</font> <font color="#434f54">=</font> <font color="#d35400">strtok</font><font color="#000000">(</font><font color="#000000">buff</font><font color="#434f54">,</font> <font color="#005c5f">&#34; =&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">name</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#434f54">*</font><font color="#000000">junk</font> <font color="#434f54">=</font> <font color="#d35400">strtok</font><font color="#000000">(</font><font color="#00979c">NULL</font><font color="#434f54">,</font> <font color="#005c5f">&#34; &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">junk</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#434f54">*</font><font color="#000000">valu</font> <font color="#434f54">=</font> <font color="#d35400">strtok</font><font color="#000000">(</font><font color="#00979c">NULL</font><font color="#434f54">,</font> <font color="#005c5f">&#34; &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">valu</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">int</font> <font color="#000000">val</font> <font color="#434f54">=</font> <font color="#d35400">atoi</font><font color="#000000">(</font><font color="#000000">valu</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">strcmp</font><font color="#000000">(</font><font color="#d35400">name</font><font color="#434f54">,</font> <font color="#005c5f">&#34;actFileCount&#34;</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">0</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">actFileCountR</font> <font color="#434f54">=</font> <font color="#000000">val</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">strcmp</font><font color="#000000">(</font><font color="#d35400">name</font><font color="#434f54">,</font> <font color="#005c5f">&#34;actCounter&#34;</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">0</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">actCounterR</font> <font color="#434f54">=</font> <font color="#000000">val</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">readFileLog</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#005c5f">&#34;filelog.txt&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">5</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">byte</font> <font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">available</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Serial.write(myFile.read());</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#000000">c</font> <font color="#434f54">=</font> <font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">read</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\n&#39;</font> <font color="#434f54">||</font> <font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\r&#39;</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Check for carriage return or line feed</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">parseAndsave</font><font color="#000000">(</font><font color="#d35400">buffer</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#434f54">++</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#000000">c</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR READING FILE LOG!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">readFileLog</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;actFileCount: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">actFileCountR</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;actCounter: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">actCounterR</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">logData</font><font color="#000000">(</font><font color="#00979c">String</font> <font color="#000000">userOrientation</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">exists</font><font color="#000000">(</font><font color="#005c5f">&#34;Activities&#34;</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">mkdir</font><font color="#000000">(</font><font color="#005c5f">&#34;Activities&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">chdir</font><font color="#000000">(</font><font color="#005c5f">&#34;Activities&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">chdir</font><font color="#000000">(</font><font color="#005c5f">&#34;Activities&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#00979c">String</font> <font color="#000000">fileName</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;activity&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">fileName</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">actFileCountR</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">fileName</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;.txt&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">actCounterR</font> <font color="#434f54">&lt;</font> <font color="#000000">maxAct</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#434f54">,</font> <font color="#00979c">FILE_WRITE</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">lastKnownTimeLoc</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">userOrientation</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;-end_of_activity-&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">actCounterR</font><font color="#434f54">++</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">actCounterR</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Serial.println(sendData(&#34;AT+CGNSINF&#34;, 1000, DEBUG));</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">lastKnownTimeLoc</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;User Orientation: &#34;</font> <font color="#434f54">+</font> <font color="#000000">userOrientation</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;-end_of_activity-&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Error Writing Activity File&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">actFileCountR</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">actCounterR</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">chdir</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Error Going back to the root folder&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#000000">updateFileLog</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">updateFileLog</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">a</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;actFileCount = &#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">b</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;actCounter = &#34;</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">a</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">actFileCountR</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">b</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">actCounterR</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">removeFile</font><font color="#000000">(</font><font color="#005c5f">&#34;filelog.txt&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#005c5f">&#34;filelog.txt&#34;</font><font color="#434f54">,</font> <font color="#00979c">FILE_WRITE</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">a</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">b</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">a</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">b</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR UPDATING FILE LOG!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">removeFile</font><font color="#000000">(</font><font color="#00979c">String</font> <font color="#000000">toRemove</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#000000">toRemove</font><font color="#434f54">,</font> <font color="#00979c">FILE_WRITE</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">remove</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR REMOVING OLD FILE LOG!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR OPENING FILE TO BE REMOVED!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">deleteOldFiles</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Deleting old files&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">chdir</font><font color="#000000">(</font><font color="#005c5f">&#34;Activities&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#434f54">&#47;&#47;sd.ls(LS_R);</font>

 &nbsp;<font color="#00979c">int</font> <font color="#000000">counter</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">int</font> <font color="#000000">itemsToDelete</font> <font color="#434f54">=</font> <font color="#000000">5</font><font color="#000000">;</font>

 &nbsp;<font color="#00979c">char</font> <font color="#d35400">name</font><font color="#000000">[</font><font color="#000000">20</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">file</font><font color="#434f54">.</font><font color="#000000">openNext</font><font color="#000000">(</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">vwd</font><font color="#000000">(</font><font color="#000000">)</font><font color="#434f54">,</font> <font color="#000000">O_READ</font><font color="#000000">)</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">counter</font> <font color="#434f54">&lt;</font> <font color="#000000">itemsToDelete</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47; &nbsp;&nbsp;&nbsp;file.printName();</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">file</font><font color="#434f54">.</font><font color="#000000">getName</font><font color="#000000">(</font><font color="#d35400">name</font><font color="#434f54">,</font> <font color="#000000">20</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;20bytes</font>

 &nbsp;&nbsp;&nbsp;<font color="#000000">removeFile</font><font color="#000000">(</font><font color="#00979c">String</font><font color="#000000">(</font><font color="#d35400">name</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#000000">file</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">counter</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">chdir</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR RETURNING BACK TO THE ROOT&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">2000</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">initMainBoard</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Initializing IMU device...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">CurieIMU</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">1000</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47; Set the accelerometer range to 2G</font>
 &nbsp;<font color="#d35400">CurieIMU</font><font color="#434f54">.</font><b><font color="#d35400">setAccelerometerRange</font></b><font color="#000000">(</font><font color="#000000">2</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;IMU initialization successful!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">initExtAccel</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Initializing External Acceleromter...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47; Join I2C bus (I2Cdev library doesn&#39;t do this automatically)</font>
<font color="#5e6d03">#if</font> <font color="#000000">I2CDEV_IMPLEMENTATION</font> <font color="#434f54">==</font> <font color="#000000">I2CDEV_ARDUINO_WIRE</font>
 &nbsp;<font color="#000000">Wire</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#5e6d03">#elif</font> <font color="#000000">I2CDEV_IMPLEMENTATION</font> <font color="#434f54">==</font> <font color="#000000">I2CDEV_BUILTIN_FASTWIRE</font>
 &nbsp;<font color="#000000">Fastwire</font><font color="#434f54">:</font><font color="#434f54">:</font><font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">400</font><font color="#434f54">,</font> <font color="#00979c">true</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#5e6d03">#endif</font>

 &nbsp;<font color="#000000">accelgyro</font><font color="#434f54">.</font><font color="#d35400">initialize</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">1000</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Verify Connection with the external accelerometer</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Testing external accelerometer connection...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">accelgyro</font><font color="#434f54">.</font><font color="#000000">testConnection</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">?</font> <font color="#005c5f">&#34;MPU6050 connection successful&#34;</font> <font color="#434f54">:</font> <font color="#005c5f">&#34;MPU6050 connection failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">accelgyro</font><font color="#434f54">.</font><font color="#000000">setSleepEnabled</font><font color="#000000">(</font><font color="#00979c">false</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">accelgyro</font><font color="#434f54">.</font><font color="#000000">testConnection</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#000000">0</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Reinitialization started!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">500</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">write</font><font color="#000000">(</font><font color="#000000">12</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;External Accelerometer initialization successful!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#5e6d03">#if</font> <font color="#000000">USE_SDIO</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">cardBegin</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;cardBegin failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">SD_CHIP_SELECT</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;SD Chip Select initialization failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#5e6d03">#else</font> &nbsp;<font color="#434f54">&#47;&#47; USE_SDIO</font>
 &nbsp;<font color="#434f54">&#47;&#47; Initialize at the highest speed supported by the board that is</font>
 &nbsp;<font color="#434f54">&#47;&#47; not over 50 MHz. Try a lower speed if SPI errors occur.</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">cardBegin</font><font color="#000000">(</font><font color="#000000">SD_CHIP_SELECT</font><font color="#434f54">,</font> <font color="#000000">SD_SCK_MHZ</font><font color="#000000">(</font><font color="#000000">50</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;cardBegin failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">SD_CHIP_SELECT</font><font color="#434f54">,</font> <font color="#000000">SD_SCK_MHZ</font><font color="#000000">(</font><font color="#000000">50</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;SD Chip Select initialization failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#5e6d03">#endif</font> &nbsp;<font color="#434f54">&#47;&#47; USE_SDIO </font>

 &nbsp;<font color="#000000">cardSize</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">card</font><font color="#000000">(</font><font color="#000000">)</font><font color="#434f54">-</font><font color="#434f54">&gt;</font><font color="#000000">cardSize</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">cardSize</font> <font color="#434f54">==</font> <font color="#000000">0</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;cardSize failed&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#434f54">!</font><font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">fsBegin</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;\nFile System initialization failed.\n&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Re-initializing Sd Card...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Sd Card initialization successful!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">checkGPSConnection</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">response</font> <font color="#434f54">=</font> <font color="#000000">sendData</font><font color="#000000">(</font><font color="#005c5f">&#34;AT+CGNSINF&#34;</font><font color="#434f54">,</font> <font color="#000000">1000</font><font color="#434f54">,</font> <font color="#000000">DEBUG</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Check if GPS is already connected&#47;fixed</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">response</font><font color="#000000">[</font><font color="#000000">25</font><font color="#000000">]</font> <font color="#434f54">==</font> <font color="#00979c">&#39;1&#39;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">GPSready</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">lastKnownTimeLoc</font> <font color="#434f54">=</font> <font color="#000000">response</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;GPS READY!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">GPSready</font><font color="#434f54">,</font> <font color="#434f54">!</font><font color="#d35400">digitalRead</font><font color="#000000">(</font><font color="#000000">GPSready</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;GPS Connecting...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;uncomment if not testing</font>
 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;lastKnownTimeLoc = &#34;1,1,20180228034035.000,14.253815,121.056955,84.500,0.43,292.5,1,,0.9,1.2,0.9,,11,9,,,34,,&#34;;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">response</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">fallBuzz</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#d35400">tone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#434f54">,</font> <font color="#000000">400</font><font color="#434f54">,</font> <font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">noTone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">tone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#434f54">,</font> <font color="#000000">500</font><font color="#434f54">,</font> <font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">noTone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">tone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#434f54">,</font> <font color="#000000">600</font><font color="#434f54">,</font> <font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">200</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">noTone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">memoryBuzz</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#d35400">tone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#434f54">,</font> <font color="#000000">300</font><font color="#434f54">,</font> <font color="#000000">300</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">300</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">noTone</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">initGPSModule</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Initializing GPS,GSM,RTC Shield...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">38400</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">GPSready</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">onGPS</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">lastKnownTimeLoc</font> <font color="#434f54">==</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">checkGPSConnection</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">10000</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">onGPS</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">sendData</font><font color="#000000">(</font><font color="#005c5f">&#34;AT+CGNSPWR=1&#34;</font><font color="#434f54">,</font> <font color="#000000">1000</font><font color="#434f54">,</font> <font color="#000000">DEBUG</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;GPS Turned ON!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">offGPS</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">sendData</font><font color="#000000">(</font><font color="#005c5f">&#34;AT+CGNSPWR=0&#34;</font><font color="#434f54">,</font> <font color="#000000">1000</font><font color="#434f54">,</font> <font color="#000000">DEBUG</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;GPS Turned OFF!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">String</font> <font color="#000000">sendData</font><font color="#000000">(</font><font color="#00979c">String</font> <font color="#000000">command</font><font color="#434f54">,</font> <font color="#00979c">const</font> <font color="#00979c">int</font> <font color="#000000">timeout</font><font color="#434f54">,</font> <font color="#00979c">boolean</font> <font color="#000000">debug</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">response</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">command</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">5</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">debug</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">long</font> <font color="#00979c">int</font> <font color="#d35400">time</font> <font color="#434f54">=</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font> <font color="#000000">(</font><font color="#d35400">time</font> <font color="#434f54">+</font> <font color="#000000">timeout</font><font color="#000000">)</font> <font color="#434f54">&gt;</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">available</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">response</font> <font color="#434f54">+=</font> <font color="#00979c">char</font><font color="#000000">(</font><font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">read</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#5e6d03">return</font> <font color="#000000">response</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">checkSpace</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">float</font> <font color="#000000">totalSize</font> <font color="#434f54">=</font> <font color="#000000">0.000512</font> <font color="#434f54">*</font> <font color="#000000">cardSize</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">float</font> <font color="#000000">freeSize</font> <font color="#434f54">=</font> <font color="#000000">0.000512</font> <font color="#434f54">*</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">vol</font><font color="#000000">(</font><font color="#000000">)</font><font color="#434f54">-</font><font color="#434f54">&gt;</font><font color="#000000">freeClusterCount</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">*</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#000000">vol</font><font color="#000000">(</font><font color="#000000">)</font><font color="#434f54">-</font><font color="#434f54">&gt;</font><font color="#000000">blocksPerCluster</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#00979c">float</font> <font color="#000000">lowLevel</font> <font color="#434f54">=</font> <font color="#000000">0.1</font> <font color="#434f54">*</font> <font color="#000000">totalSize</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;10% of total size</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">freeSize</font> <font color="#434f54">&lt;=</font> <font color="#000000">lowLevel</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">memoryBuzz</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">deleteOldFiles</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;LOW MEMORY SPACE!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Remaining Space: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">freeSize</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34; MB (MB = 1,000,000 bytes)&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;Remaining Space: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">freeSize</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">String</font> <font color="#000000">setMessage</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">message</font> <font color="#434f54">=</font> <font color="#000000">userName</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34; fell! at: &nbsp;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">date</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">longitude</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">latitude</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">int</font> <font color="#000000">comma</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">int</font> <font color="#000000">i</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">comma</font> <font color="#434f54">&lt;=</font> <font color="#000000">5</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">lastKnownTimeLoc</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font> <font color="#434f54">==</font> <font color="#00979c">&#39;,&#39;</font> <font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">comma</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>

 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">comma</font> <font color="#434f54">==</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">date</font> <font color="#434f54">=</font> <font color="#000000">date</font> <font color="#434f54">+</font> <font color="#000000">lastKnownTimeLoc</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">comma</font> <font color="#434f54">==</font> <font color="#000000">3</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">longitude</font> <font color="#434f54">=</font> <font color="#000000">longitude</font> <font color="#434f54">+</font> <font color="#000000">lastKnownTimeLoc</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">comma</font> <font color="#434f54">==</font> <font color="#000000">4</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">latitude</font> <font color="#434f54">=</font> <font color="#000000">latitude</font> <font color="#434f54">+</font> <font color="#000000">lastKnownTimeLoc</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#00979c">String</font> <font color="#000000">newTime</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">newDate</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">j</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">j</font> <font color="#434f54">&lt;</font> <font color="#000000">14</font><font color="#000000">;</font> <font color="#000000">j</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">j</font> <font color="#434f54">&lt;</font> <font color="#000000">8</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">newDate</font> <font color="#434f54">=</font> <font color="#000000">newDate</font> <font color="#434f54">+</font> <font color="#000000">date</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">j</font> <font color="#434f54">==</font> <font color="#000000">3</font> <font color="#434f54">||</font> <font color="#000000">j</font> <font color="#434f54">==</font> <font color="#000000">5</font> <font color="#434f54">||</font> <font color="#000000">j</font> <font color="#434f54">==</font> <font color="#000000">5</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">newDate</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;-&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">j</font> <font color="#434f54">&gt;</font> <font color="#000000">7</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">newTime</font> <font color="#434f54">=</font> <font color="#000000">newTime</font> <font color="#434f54">+</font> <font color="#000000">date</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;
 &nbsp;<font color="#00979c">String</font> <font color="#000000">hh</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">j</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">j</font> <font color="#434f54">&lt;</font> <font color="#000000">2</font><font color="#000000">;</font> <font color="#000000">j</font><font color="#434f54">++</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">hh</font> <font color="#434f54">=</font> <font color="#000000">hh</font> <font color="#434f54">+</font> <font color="#000000">newTime</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#00979c">int</font> <font color="#000000">timeUTC8</font> <font color="#434f54">=</font> <font color="#000000">hh</font><font color="#434f54">.</font><font color="#d35400">toInt</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font><font color="#000000">(</font><font color="#000000">timeUTC8</font> <font color="#434f54">&gt;</font> <font color="#000000">12</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">timeUTC8</font> <font color="#434f54">=</font> <font color="#000000">timeUTC8</font> <font color="#434f54">-</font> <font color="#000000">12</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;
 &nbsp;<font color="#000000">timeUTC8</font> <font color="#434f54">=</font> <font color="#000000">hh</font><font color="#434f54">.</font><font color="#d35400">toInt</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">+</font> <font color="#000000">8</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font><font color="#000000">(</font><font color="#000000">timeUTC8</font> <font color="#434f54">&gt;</font> <font color="#000000">24</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">timeUTC8</font> <font color="#434f54">=</font> <font color="#000000">timeUTC8</font> <font color="#434f54">-</font> <font color="#000000">24</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;
 &nbsp;<font color="#00979c">String</font> <font color="#000000">UTC8</font> <font color="#434f54">=</font> <font color="#00979c">String</font><font color="#000000">(</font><font color="#000000">timeUTC8</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">for</font><font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">j</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">j</font> <font color="#434f54">&lt;</font> <font color="#000000">6</font><font color="#000000">;</font> <font color="#000000">j</font><font color="#434f54">++</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font><font color="#000000">(</font><font color="#000000">j</font> <font color="#434f54">==</font> <font color="#000000">1</font> <font color="#434f54">||</font> <font color="#000000">j</font> <font color="#434f54">==</font> <font color="#000000">4</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">UTC8</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;:&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font><font color="#000000">(</font><font color="#000000">j</font> <font color="#434f54">&gt;</font> <font color="#000000">1</font><font color="#000000">)</font><font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">UTC8</font> <font color="#434f54">=</font> <font color="#000000">UTC8</font> <font color="#434f54">+</font> <font color="#000000">newTime</font><font color="#000000">[</font><font color="#000000">j</font><font color="#000000">]</font><font color="#000000">;</font> &nbsp;&nbsp;
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;\n&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;LONGITUDE and LATITUDE: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;\n&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">longitude</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;, &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">latitude</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;\n&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;DATE: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">newDate</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;\n&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;TIME: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">UTC8</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">message</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34; \r&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">message</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">return</font> <font color="#000000">message</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">initUsername</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#005c5f">&#34;profile.txt&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">15</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">byte</font> <font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">int</font> <font color="#000000">lineCount</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">available</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">lineCount</font> <font color="#434f54">&lt;</font> <font color="#000000">3</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#000000">c</font> <font color="#434f54">=</font> <font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">read</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\n&#39;</font> <font color="#434f54">||</font> <font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\r&#39;</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Check for carriage return or line feed</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">userName</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#d35400">buffer</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">lineCount</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#434f54">++</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#000000">c</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>

 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR READING PROFILE!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#000000">SendTextMessage</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">offGPS</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;turn off GPS to prevent interruption</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;======================&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;===SENDING MESSAGE!===&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#00979c">String</font> <font color="#000000">message</font> <font color="#434f54">=</font> <font color="#000000">setMessage</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">myFile</font> <font color="#434f54">=</font> <font color="#000000">sd</font><font color="#434f54">.</font><font color="#d35400">open</font><font color="#000000">(</font><font color="#005c5f">&#34;respondents.txt&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">15</font><font color="#000000">]</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">byte</font> <font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">available</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">char</font> <font color="#000000">c</font> <font color="#434f54">=</font> <font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">read</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">boolean</font> <font color="#000000">sent</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\n&#39;</font> <font color="#434f54">||</font> <font color="#000000">c</font> <font color="#434f54">==</font> <font color="#00979c">&#39;\r&#39;</font><font color="#000000">)</font> <font color="#000000">{</font> <font color="#434f54">&#47;&#47;Check for carriage return or line feed</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">0</font><font color="#000000">]</font> <font color="#434f54">==</font> <font color="#00979c">&#39;+&#39;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">String</font> <font color="#000000">toContact</font><font color="#000000">(</font><font color="#d35400">buffer</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;CONTACT NUMBER: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">toContact</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">sent</font> <font color="#434f54">==</font> <font color="#00979c">false</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">String</font> <font color="#000000">response</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">String</font> <font color="#000000">receiver</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;AT+CMGS=\&#34;&#34;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">receiver</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#000000">toContact</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">receiver</font><font color="#434f54">.</font><font color="#d35400">concat</font><font color="#000000">(</font><font color="#005c5f">&#34;\&#34;\r&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">receiver</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;\r&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;AT+CMGF=1\r&#34;</font><font color="#000000">)</font><font color="#000000">;</font> &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Because we want to send the SMS in text mode</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">receiver</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">1000</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">message</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">write</font><font color="#000000">(</font><font color="#000000">0x1A</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">long</font> <font color="#00979c">int</font> <font color="#d35400">time</font> <font color="#434f54">=</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">(</font><font color="#d35400">time</font> <font color="#434f54">+</font> <font color="#000000">1000</font><font color="#000000">)</font> <font color="#434f54">&gt;</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">available</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">response</font> <font color="#434f54">+=</font> <font color="#00979c">char</font><font color="#000000">(</font><font color="#000000">mySerial</font><font color="#434f54">.</font><font color="#d35400">read</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;RESPONSE: &#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#000000">response</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#00979c">int</font> <font color="#000000">bracketCount</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">for</font> <font color="#000000">(</font><font color="#00979c">int</font> <font color="#000000">i</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font> <font color="#000000">i</font> <font color="#434f54">&lt;</font> <font color="#000000">response</font><font color="#434f54">.</font><font color="#d35400">length</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#000000">i</font><font color="#434f54">++</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">response</font><font color="#000000">[</font><font color="#000000">i</font><font color="#000000">]</font> <font color="#434f54">==</font> <font color="#00979c">&#39;&gt;&#39;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">bracketCount</font><font color="#434f54">++</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">bracketCount</font> <font color="#434f54">&gt;=</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">sent</font> <font color="#434f54">=</font> <font color="#00979c">true</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;===MESSAGE SENT!===&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;===MESSAGE WAS NOT SENT!===&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Resending Message...&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">sent</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">index</font> <font color="#434f54">=</font> <font color="#000000">0</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#434f54">++</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#000000">c</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d35400">buffer</font><font color="#000000">[</font><font color="#000000">index</font><font color="#000000">]</font> <font color="#434f54">=</font> <font color="#00979c">&#39;\0&#39;</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;Keep buffer NULL terminated</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">myFile</font><font color="#434f54">.</font><font color="#d35400">close</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;ERROR READING RESPONDENTS FILE!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;===DONE!===&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;======================&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">5000</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">onGPS</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;turon on GPS again</font>
<font color="#000000">}</font>

<font color="#00979c">String</font> <font color="#000000">getOrientation</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">byEx</font> <font color="#434f54">=</font> <font color="#000000">ayEx</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">accelgyro</font><font color="#434f54">.</font><font color="#000000">getMotion6</font><font color="#000000">(</font><font color="#434f54">&amp;</font><font color="#000000">axEx</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">ayEx</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">azEx</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">gxEx</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">gyEx</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">gzEx</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;mpu6050</font>
 &nbsp;<font color="#d35400">CurieIMU</font><font color="#434f54">.</font><b><font color="#d35400">readAccelerometer</font></b><font color="#000000">(</font><font color="#000000">axIn</font><font color="#434f54">,</font> <font color="#000000">ayIn</font><font color="#434f54">,</font> <font color="#000000">azIn</font><font color="#000000">)</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47; curie</font>

 &nbsp;<font color="#000000">vsumcurrentEx</font> <font color="#434f54">=</font> <font color="#d35400">sqrt</font><font color="#000000">(</font><font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">axEx</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#434f54">+</font> <font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">ayEx</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#434f54">+</font> <font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">azEx</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">vsumcheckEx</font> <font color="#434f54">=</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumnewEx</font><font color="#000000">)</font> <font color="#434f54">-</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcurrentEx</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#434f54">&#47;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumnewEx</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#434f54">*</font> <font color="#000000">100</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">vsumcurrentIn</font> <font color="#434f54">=</font> <font color="#d35400">sqrt</font><font color="#000000">(</font><font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">axIn</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#434f54">+</font> <font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">ayIn</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font> <font color="#434f54">+</font> <font color="#d35400">pow</font><font color="#000000">(</font><font color="#000000">azIn</font><font color="#434f54">,</font> <font color="#000000">2</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">vsumcheckIn</font> <font color="#434f54">=</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumnewIn</font><font color="#000000">)</font> <font color="#434f54">-</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcurrentIn</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#434f54">&#47;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumnewIn</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#434f54">*</font> <font color="#000000">100</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">1.5</font> <font color="#434f54">&amp;&amp;</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">1.5</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">vsumnewEx</font> <font color="#434f54">=</font> <font color="#000000">vsumcurrentEx</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">vsumnewIn</font> <font color="#434f54">=</font> <font color="#000000">vsumcurrentIn</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">return</font> <font color="#000000">dynamicmode</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">vsumnewEx</font> <font color="#434f54">=</font> <font color="#000000">(</font><font color="#000000">vsumnewEx</font> <font color="#434f54">+</font> <font color="#000000">vsumcurrentEx</font><font color="#000000">)</font> <font color="#434f54">&#47;</font> <font color="#000000">2</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;average vector sum</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">vsumnewIn</font> <font color="#434f54">=</font> <font color="#000000">(</font><font color="#000000">vsumnewIn</font> <font color="#434f54">+</font> <font color="#000000">vsumcurrentIn</font><font color="#000000">)</font> <font color="#434f54">&#47;</font> <font color="#000000">2</font><font color="#000000">;</font> <font color="#434f54">&#47;&#47;average vector sum</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">return</font> <font color="#000000">staticmode</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">void</font> <font color="#5e6d03">setup</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">begin</font><font color="#000000">(</font><font color="#000000">38400</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">delay</font><font color="#000000">(</font><font color="#000000">1000</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#434f54">!</font><b><font color="#d35400">Serial</font></b><font color="#000000">)</font> <font color="#000000">{</font><font color="#000000">}</font> <font color="#434f54">&#47;&#47;wait for serial port to connect</font>

 &nbsp;<font color="#434f54">&#47;&#47;Initialize the devices</font>
 &nbsp;<font color="#000000">initMainBoard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">initExtAccel</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">initSDCard</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">readFileLog</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">initUsername</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">initGPSModule</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">FallMemory</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">DeviceReady</font><font color="#434f54">,</font> <font color="#00979c">OUTPUT</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">pinMode</font><font color="#000000">(</font><font color="#000000">falseAlarmButton</font><font color="#434f54">,</font> <font color="#00979c">INPUT_PULLUP</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">CurieTimerOne</font><font color="#434f54">.</font><font color="#d35400">start</font><font color="#000000">(</font><font color="#000000">memoryTimer</font><font color="#434f54">,</font> <font color="#434f54">&amp;</font><font color="#000000">checkSpace</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47;Prompt a welcome message</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;Device is ready!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<font color="#d35400">digitalWrite</font><font color="#000000">(</font><font color="#000000">DeviceReady</font><font color="#434f54">,</font> <font color="#00979c">HIGH</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;===============================&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">boolean</font> <font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>

<font color="#00979c">void</font> <font color="#5e6d03">loop</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;<font color="#000000">checkGPSConnection</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>
 &nbsp;<font color="#00979c">String</font> <font color="#000000">currentOrientation</font> <font color="#434f54">=</font> <font color="#000000">getOrientation</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">currentOrientation</font> <font color="#434f54">!=</font> <font color="#005c5f">&#34;UNKNOWN&#34;</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">currentOrientation</font> <font color="#434f54">!=</font> <font color="#000000">lastOrientation</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">logData</font><font color="#000000">(</font><font color="#000000">currentOrientation</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#005c5f">&#34;=====&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">print</font><font color="#000000">(</font><font color="#000000">currentOrientation</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;=====&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;&#34;</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">lastOrientation</font> <font color="#434f54">=</font> <font color="#000000">currentOrientation</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#434f54">&#47;&#47;if falling</font>
<font color="#434f54">&#47;&#47; &nbsp;falling = true; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#47;&#47;just for testing</font>
<font color="#434f54">&#47;&#47; &nbsp;fallStart = millis(); &nbsp;&nbsp;&#47;&#47;just for testing</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">falling</font> <font color="#434f54">==</font> <font color="#00979c">true</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;check wether to send an alarm in 10 seconds</font>
 &nbsp;&nbsp;&nbsp;<font color="#00979c">boolean</font> <font color="#000000">flag</font> <font color="#434f54">=</font> <font color="#00979c">true</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">while</font> <font color="#000000">(</font><font color="#000000">flag</font> <font color="#434f54">==</font> <font color="#00979c">true</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#434f54">-</font> <font color="#000000">fallStart</font> <font color="#434f54">&lt;=</font> <font color="#000000">10000</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">digitalRead</font><font color="#000000">(</font><font color="#000000">falseAlarmButton</font><font color="#000000">)</font> <font color="#434f54">==</font> <font color="#00979c">LOW</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color="#d35400">Serial</font></b><font color="#434f54">.</font><font color="#d35400">println</font><font color="#000000">(</font><font color="#005c5f">&#34;False Alarm!&#34;</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">flag</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;Serial.println(millis() - fallStart);</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fallBuzz</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">SendTextMessage</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47;setMessage();</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">flag</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#000000">}</font>
<font color="#000000">}</font>

<font color="#00979c">static</font> <font color="#00979c">String</font> <font color="#000000">staticmode</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>

 &nbsp;<font color="#00979c">String</font> <font color="#000000">staticstr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;UNKNOWN&#34;</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">axEx</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">13900</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">axIn</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">16000</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">axIn</font> <font color="#434f54">&gt;=</font> <font color="#434f54">-</font><font color="#000000">17500</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">staticstr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Standing Position&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">ayEx</font> <font color="#434f54">&gt;=</font> <font color="#000000">14000</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">axIn</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">12500</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">staticstr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Sitting Position&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font> <font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">azIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> &nbsp;<font color="#000000">13500</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">ayIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> &nbsp;<font color="#000000">13500</font><font color="#000000">)</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">azEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> &nbsp;<font color="#000000">13500</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">ayEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> &nbsp;<font color="#000000">13500</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">staticstr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Lying Position&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>

 &nbsp;<font color="#5e6d03">return</font> <font color="#000000">staticstr</font><font color="#000000">;</font>
<font color="#000000">}</font>

<font color="#00979c">static</font> <font color="#00979c">String</font> <font color="#000000">dynamicmode</font><font color="#000000">(</font><font color="#000000">)</font> <font color="#000000">{</font>

 &nbsp;<font color="#00979c">String</font> <font color="#000000">dynastr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;UNKNOWN&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">false</font><font color="#000000">;</font>

 &nbsp;<font color="#000000">degreesdiff</font> <font color="#434f54">=</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">(</font><font color="#000000">(</font><font color="#000000">180</font> <font color="#434f54">&#47;</font> <font color="#000000">3.14</font><font color="#000000">)</font> <font color="#434f54">*</font> <font color="#000000">(</font><font color="#d35400">acos</font><font color="#000000">(</font><font color="#000000">ayEx</font> <font color="#434f54">&#47;</font> <font color="#000000">vsumnewEx</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font> <font color="#434f54">-</font> <font color="#000000">(</font><font color="#000000">(</font><font color="#000000">180</font> <font color="#434f54">&#47;</font> <font color="#000000">3.14</font><font color="#000000">)</font> <font color="#434f54">*</font> <font color="#000000">(</font><font color="#d35400">acos</font><font color="#000000">(</font><font color="#000000">byEx</font> <font color="#434f54">&#47;</font> <font color="#000000">vsumnewEx</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">)</font><font color="#000000">;</font>

 &nbsp;<font color="#434f54">&#47;&#47; &nbsp;Serial.print((abs((vsumnew-abs(ayEx))&#47;vsumnew))*9.8);</font>
 &nbsp;<font color="#434f54">&#47;&#47; &nbsp;Serial.println(&#34; m&#47;s^2&#34;);</font>
 &nbsp;<font color="#434f54">&#47;&#47;</font>

 &nbsp;<font color="#00979c">int</font> <font color="#000000">fallTreshold</font> <font color="#434f54">=</font> <font color="#000000">10</font><font color="#000000">;</font>

 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">ayIn</font> <font color="#434f54">&gt;=</font> <font color="#000000">13500</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">ayEx</font> <font color="#434f54">&gt;=</font> <font color="#000000">15900</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fallStart</font> <font color="#434f54">=</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">dynastr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Falling! : Backwards&#34;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">true</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">ayIn</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">14000</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">ayEx</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">15400</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fallStart</font> <font color="#434f54">=</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">dynastr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Falling! : Forward&#34;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">true</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>
 &nbsp;&nbsp;&nbsp;<font color="#5e6d03">else</font> <font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">azIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> &nbsp;<font color="#000000">15900</font> <font color="#434f54">&amp;&amp;</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">azEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">15400</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">(</font><font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckEx</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#434f54">||</font> <font color="#d35400">abs</font><font color="#000000">(</font><font color="#000000">vsumcheckIn</font><font color="#000000">)</font> <font color="#434f54">&gt;=</font> <font color="#000000">fallTreshold</font> <font color="#000000">)</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">fallStart</font> <font color="#434f54">=</font> <font color="#d35400">millis</font><font color="#000000">(</font><font color="#000000">)</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">dynastr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Falling! : Sideways&#34;</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#000000">falling</font> <font color="#434f54">=</font> <font color="#00979c">true</font><font color="#000000">;</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">}</font>

 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47; &nbsp;Serial.print((abs(vsumcheck&#47;100))*9.8);</font>
 &nbsp;&nbsp;&nbsp;<font color="#434f54">&#47;&#47; &nbsp;Serial.println(&#34; m&#47;s^2&#34;);</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">if</font> <font color="#000000">(</font><font color="#000000">(</font><font color="#000000">axIn</font> <font color="#434f54">&lt;=</font> <font color="#434f54">-</font><font color="#000000">15000</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">axIn</font> <font color="#434f54">&gt;=</font> <font color="#434f54">-</font><font color="#000000">17500</font><font color="#000000">)</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">degreesdiff</font> <font color="#434f54">&lt;=</font> <font color="#000000">55</font> <font color="#434f54">&amp;&amp;</font> <font color="#000000">degreesdiff</font> <font color="#434f54">&gt;=</font> <font color="#000000">10</font><font color="#000000">)</font> <font color="#000000">{</font>
 &nbsp;&nbsp;&nbsp;<font color="#000000">dynastr</font> <font color="#434f54">=</font> <font color="#005c5f">&#34;Walking&#34;</font><font color="#000000">;</font>
 &nbsp;<font color="#000000">}</font>
 &nbsp;<font color="#5e6d03">return</font> <font color="#000000">dynastr</font><font color="#000000">;</font>
<font color="#000000">}</font>

</pre>